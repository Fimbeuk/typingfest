// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  // Note: DATABASE_URL doit être définie dans les variables d'environnement
  // Pour le build local, vous pouvez créer un fichier .env avec une URL factice
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  username  String?  @unique
  runs      Run[]
  createdAt DateTime @default(now())
}

model Challenge {
  id        String   @id @default(uuid())
  slug      String   @unique
  title     String
  author    String
  text      String
  runs      Run[]
}

model Run {
  id                    String    @id @default(uuid())
  userId                String
  challengeId           String
  durationMs            Int
  validCharsCount       Int
  invalidKeystrokesCount Int
  wpm                   Float
  cpm                   Float
  createdAt             DateTime  @default(now())

  user      User      @relation(fields: [userId], references: [id])
  challenge Challenge @relation(fields: [challengeId], references: [id])
}
